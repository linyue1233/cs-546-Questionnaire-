<div>
    {{!-- Show only if current user if the poster of the question --}}
    <div class="card">
        <div class="card-body">
        {{#if currentUserPostedQuestion}}
            <span><h1>{{questionInfo.title}}</h1>
                <p>{{questionInfo.description}}</p>
                <div class="votingsystem">
                    {{#if thisUserUpvoted}}
                        <i class="fas fa-thumbs-up upvote" data-id="/questions/{{questionInfo._id}}/upvote"></i>
                    {{/if}}
                    {{#unless thisUserUpvoted}}
                        <i class="far fa-thumbs-up upvote" data-id="/questions/{{questionInfo._id}}/upvote"></i>
                    {{/unless}}
                    <span class="label label-primary votecounter">{{ questionInfo.votes }}</span>
                    {{#if thisUserDownvoted}}
                        <i class="fas fa-thumbs-down downvote" data-id="/questions/{{questionInfo._id}}/downvote"></i>
                    {{/if}}
                    {{#unless thisUserDownvoted}}
                        <i class="far fa-thumbs-down downvote" data-id="/questions/{{questionInfo._id}}/downvote"></i>
                    {{/unless}}
                </div>      
            <a>{{ post.title }}</a>
                <div class="posterInfo">
                    <p>Posted By: <a href="/users/{{questionPoster._id}}/profile">{{questionPoster.displayName}}</a></p>
                    <p>Posted On: {{questionInfo.friendlyCreatedAt}}</p>
                    <p>Last Updated On: {{ questionInfo.friendlyUpdatedAt}}</p>
                </div>    
            <br>
            <button class="btn btn-light"><a href="/questions/{{questionInfo._id}}/edit">Edit</a></button>
            <button class="btn btn-light"><a href="/questions/{{questionInfo._id}}/delete">Delete</a></button>
            {{#if userLoggedIn}}
                <button class="btn btn-danger" id="reportQuestion" data-id="/questions/{{questionInfo._id}}/report">Report</button>
            {{/if}}
        {{/if}}
        
        {{#unless currentUserPostedQuestion}}
        <span><h1>{{questionInfo.title}}</h1>
            <div class="posterInfo">
                <p>Posted By: <a href="/users/{{questionPoster._id}}/profile">{{questionPoster.displayName}}</a></p>
                <p>Posted On: {{questionInfo.friendlyCreatedAt}}</p>
                <p>Last Updated On: {{ questionInfo.friendlyUpdatedAt}}</p>
            </div>
        <p>{{questionInfo.description}}</p>
        <div class="votingsystem">
                {{#if thisUserUpvoted}}
                        <i class="fas fa-thumbs-up upvote" data-id="/questions/{{questionInfo._id}}/upvote"></i>
                    {{/if}}
                    {{#unless thisUserUpvoted}}
                        <i class="far fa-thumbs-up upvote" data-id="/questions/{{questionInfo._id}}/upvote"></i>
                    {{/unless}}
                    <span class="label label-primary votecounter">{{ questionInfo.votes }}</span>
                    {{#if thisUserDownvoted}}
                        <i class="fas fa-thumbs-down downvote" data-id="/questions/{{questionInfo._id}}/downvote"></i>
                    {{/if}}
                    {{#unless thisUserDownvoted}}
                        <i class="far fa-thumbs-down downvote" data-id="/questions/{{questionInfo._id}}/downvote"></i>
                    {{/unless}}
        </div>
        {{#if userLoggedIn}}
            <button class="btn btn-danger" id="reportQuestion" data-id="/questions/{{questionInfo._id}}/report">Report</button>
        {{/if}}
        {{/unless}}
        {{#each questionInfo.tags}}
            <span class="badge badge-pill badge-info">{{this}}</span>
        {{/each}}
        </div>    
        <p>
        </p>
    </div>

<hr>

    {{#if questionInfo.answers.length}}
    <h3>Answers</h3>
    <ul class="list-group">
        {{#each questionInfo.answers}}    
        <li class="list-group-item">
            <p>{{{this.description}}}</p>
            <h5>Posted By <a href="/users/{{this.posterId}}/profile">{{this.displayName}}</a></h5>
            <p><a href='/questions/{{../questionInfo._id}}/answers/{{this._id}}/edit'>Edit Answer</a></p>
        </li>
        {{/each}}
    </ul>
    {{/if}}
</div>
<hr>
{{#if userLoggedIn}}
<h3>Post your answer here</h3>
    {{!-- build a rich text box to submit answer --}}
    {{!-- action need to modify --}}
    <form id="textSubmit" action="/questions/{{questionInfo._id}}/answers/create/" class="input-group d-inline-block" method="post">
        <textarea name="content" id="editor" required>
        </textarea>
        <br>
        <p><input class= "float-right btn btn-primary add-ans" type="submit" value="Add Answer"></p>
    </form>
    <div class="alert alert-warning alert-dismissible fade hide" id="ans-err" role="alert">
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    {{/if}}
    {{#unless userLoggedIn}}
    <h3>Contribute to this discussion by <a href="/site/login">logging in here.</a></h3>
    {{/unless}}
</div>


<script>
    ClassicEditor
        .create(document.querySelector('#editor'))
        .catch(error => {
            console.error(error);
        });
</script>
